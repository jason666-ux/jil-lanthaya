<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Watch Full Video</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
    .btn { padding: 15px 30px; font-size: 20px; cursor: pointer; border: none; border-radius: 8px; margin-top: 20px; }
    .red { background-color: red; color: white; }
    .green { background-color: green; color: white; display: none; }
    .disabled { opacity: 0.5; pointer-events: none; }
  </style>
</head>
<body>

  <h1>Watch Full Video</h1>
  <p>Click the button below to continue</p>

  <button class="btn red disabled" id="adButton">Watch Full Video</button>
  <button class="btn green" id="finalButton">Continue to Video</button>

  <p id="timer" style="font-size: 18px; margin-top: 20px;"></p>

  <script>
    // Get video code from URL
    const urlParams = new URLSearchParams(window.location.search);
    const videoCode = urlParams.get('video');

    if (!videoCode) {
      document.body.innerHTML = "<h2>Error: No video code provided!</h2>";
    }

    const adButton = document.getElementById('adButton');
    const finalButton = document.getElementById('finalButton');
    const timer = document.getElementById('timer');

    const requiredStay = 12; // seconds

    // Anti-bot: wait for real human interaction
    let humanDetected = false;
    function enableButton() {
      if (!humanDetected) {
        humanDetected = true;
        adButton.classList.remove('disabled');
      }
    }

    window.addEventListener('mousemove', enableButton);
    window.addEventListener('touchstart', enableButton);
    window.addEventListener('scroll', enableButton);

    // On page load â€” check real condition
    window.addEventListener('load', () => {
      checkUnlock();
    });

    adButton.addEventListener('click', () => {
      // Prevent bot click before human detected
      if (adButton.classList.contains('disabled')) return;

      // Save click time + mark ad visit started
      localStorage.setItem('adClickTime', Date.now());
      localStorage.setItem('adVisitInProgress', 'true');
      window.location.href = 'https://monetag.com/'; // your ad link
    });

    window.addEventListener('pageshow', () => {
      checkUnlock();
    });

    function checkUnlock() {
      let clickTime = localStorage.getItem('adClickTime');
      let visitInProgress = localStorage.getItem('adVisitInProgress');

      if (clickTime && visitInProgress === 'true') {
        let timeSpent = Math.floor((Date.now() - clickTime) / 1000);

        if (timeSpent >= requiredStay) {
          unlockButton();
        } else {
          alert(`You must stay at least ${requiredStay} seconds on the ad page! You only stayed ${timeSpent} sec.`);
          resetState();
        }
      } else {
        resetState();
      }
    }

    function unlockButton() {
      timer.innerText = "Now you can continue!";
      finalButton.style.display = "inline-block";
      adButton.style.display = "none";
      // Mark as completed, no cheat on refresh
      localStorage.setItem('adVisitInProgress', 'completed');
    }

    function resetState() {
      timer.innerText = "";
      finalButton.style.display = "none";
      adButton.style.display = "inline-block";
      // Important: do not mark completed if cheated
      localStorage.setItem('adVisitInProgress', 'false');
    }

    finalButton.addEventListener('click', () => {
      window.location.href = `https://t.me/Jil666Bot?start=${videoCode}`;
    });
  </script>

</body>
</html>
