<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Watch Full Video</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
    .btn { padding: 15px 30px; font-size: 20px; cursor: pointer; border: none; border-radius: 8px; margin-top: 20px; }
    .red { background-color: red; color: white; }
    .green { background-color: green; color: white; display: none; }
  </style>
</head>
<body>

  <h1>Watch Full Video</h1>
  <p>Click the button below to continue</p>

  <button class="btn red" id="adButton">Watch Full Video</button>
  <button class="btn green" id="finalButton">Continue to Video</button>

  <p id="timer" style="font-size: 18px; margin-top: 20px;"></p>

  <script>
    // Get video code from URL
    const urlParams = new URLSearchParams(window.location.search);
    const videoCode = urlParams.get('video');

    if (!videoCode) {
      document.body.innerHTML = "<h2>Error: No video code provided!</h2>";
    }

    const adButton = document.getElementById('adButton');
    const finalButton = document.getElementById('finalButton');
    const timer = document.getElementById('timer');

    // Bonus Protection Data
    let countdown = 12;
    let adClicked = false;
    let visitTimestamp = 0;

    // Load saved state
    if (localStorage.getItem('adClicked') === 'true') {
      adClicked = true;
      visitTimestamp = parseInt(localStorage.getItem('visitTimestamp') || '0');
      checkReturn();
    }

    adButton.addEventListener('click', () => {
      // Save timestamp
      visitTimestamp = Date.now();
      localStorage.setItem('visitTimestamp', visitTimestamp);
      localStorage.setItem('adClicked', 'true');

      // Open Adsterra link
      window.location.href = 'https://monetag.com/';
    });

    // On return to page
    window.addEventListener('pageshow', () => {
      if (localStorage.getItem('adClicked') === 'true') {
        checkReturn();
      }
    });

    function checkReturn() {
      let now = Date.now();
      let diffSec = Math.floor((now - visitTimestamp) / 1000);

      if (diffSec >= 12) {
        startCountdown();
      } else {
        let waitMore = 12 - diffSec;
        alert(`You must stay on ad page at least 12 seconds! Go back and wait ${waitMore} more seconds.`);
        localStorage.setItem('adClicked', 'false');
        window.location.reload();
      }
    }

    function startCountdown() {
      timer.innerText = `Please wait ${countdown} seconds...`;
      let interval = setInterval(() => {
        countdown--;
        timer.innerText = `Please wait ${countdown} seconds...`;
        if (countdown <= 0) {
          clearInterval(interval);
          timer.innerText = "Now you can continue!";
          finalButton.style.display = "inline-block";
          adButton.style.display = "none";
          // Clear saved data
          localStorage.removeItem('adClicked');
          localStorage.removeItem('visitTimestamp');
        }
      }, 1000);
    }

    finalButton.addEventListener('click', () => {
      window.location.href = `https://t.me/Jil666Bot?start=${videoCode}`;
    });
  </script>

</body>
</html>
